{
  "version": "2.5.0",
  "summary": {
    "title": "E- Commerce Threat Model",
    "owner": "Rahul Gupta",
    "description": "Threat model for a small e-commerce application using STRIDE",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 0,
        "title": "E-Commerce Threat Model",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.5.0",
        "cells": [
          {
            "position": {
              "x": 110,
              "y": -329.9999999999991
            },
            "size": {
              "width": 170,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Website Users"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 1,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "3dd7fed3-5732-4d97-aacd-142105008dd7"
                },
                {
                  "group": "right",
                  "id": "3d21eb4b-164d-42b5-8f61-499e10572a99"
                },
                {
                  "group": "bottom",
                  "id": "309e6664-5ee2-4897-a87e-55d3fe8ef703"
                },
                {
                  "group": "left",
                  "id": "978b9b9a-e506-4530-8081-09b29cb2ff75"
                }
              ]
            },
            "id": "b29ab300-4a03-4b5c-967f-1d683fc0554a",
            "data": {
              "type": "tm.Actor",
              "name": "Website Users",
              "description": "End user who browses products and places orders",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "bca48f85-7396-4405-a107-b574b09cc203",
                  "title": "User Identity Spoofing",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker pretends to be a valid user by stealing or guessing login credentials, gaining unauthorized access to accounts",
                  "mitigation": "Implement multi-factor authentication (MFA), enforce strong passwords, and add account lockout after repeated failures.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 1,
                  "score": ""
                },
                {
                  "id": "d4cfb4a9-f27c-4f24-8f19-8eb2ad8bf9d2",
                  "title": "Action Repudiation",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "A user denies performing actions such as placing orders or making payments due to missing logs or insufficient tracking.",
                  "mitigation": "Maintain secure audit logs, timestamped transaction records, and non-repudiation mechanisms (e.g., signed receipts).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 3,
                "repudiation": 3
              }
            }
          },
          {
            "position": {
              "x": 570,
              "y": -300
            },
            "size": {
              "width": 120,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "Web Application \nServer"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 2,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "54260c7b-849f-4b93-80c0-23afb50d0d38"
                },
                {
                  "group": "right",
                  "id": "709b1aca-a841-43a0-84f5-f0e37625b63b"
                },
                {
                  "group": "bottom",
                  "id": "ccfa68e4-3d72-45cc-a33a-2fd43f901cf4"
                },
                {
                  "group": "left",
                  "id": "a7c59c66-b9dd-427a-9263-fd748339479a"
                }
              ]
            },
            "id": "e2742f77-6dbd-4efc-ae0f-0763b8906a5a",
            "data": {
              "type": "tm.Process",
              "name": "Web Application \nServer",
              "description": "Handles business logic, authentication, and API requests",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "c8515d28-e924-46b7-99de-5db3c2932abb",
                  "title": "API Request Tampering",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attackers modify parameters in HTTP or API requests to manipulate prices, bypass checks, or execute unauthorized actions.",
                  "mitigation": "Use input validation, parameterized APIs, and digital signatures for API payloads.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": ""
                },
                {
                  "id": "0b06760b-9afe-48ac-b987-0a286ebc3b67",
                  "title": "Sensitive Data Disclosure",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "Application leaks sensitive data through unmasked error messages, insecure storage, or exposed configuration files.",
                  "mitigation": "Use HTTPS/TLS, avoid verbose errors, encrypt sensitive data in transit and at rest.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": ""
                },
                {
                  "id": "d656c9ce-0260-4b20-8cbe-9ce38905429d",
                  "title": "Service Denial (DoS Attack)",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "High-volume traffic or automated bots overload the web server, causing unavailability for genuine users.",
                  "mitigation": "Implement rate limiting, WAF (Web Application Firewall), and cloud-based DDoS protection.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": ""
                },
                {
                  "id": "3d932416-5c63-4c76-96d7-ccc0f19e94c8",
                  "title": "Privilege Escalation Exploit",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Vulnerable application code or poor access control allows attackers to gain admin privileges on the server.",
                  "mitigation": "Use role-based access control (RBAC), perform regular patching, and input validation to block code injection.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 3,
                "repudiation": 0,
                "informationDisclosure": 3,
                "denialOfService": 2,
                "elevationOfPrivilege": 3
              }
            }
          },
          {
            "position": {
              "x": 959,
              "y": -140
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Users Database"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 3,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "cefdd8c0-7c1c-4aec-87cc-993242a27c62"
                },
                {
                  "group": "right",
                  "id": "ee5eb2c3-ef0d-4dbd-a559-480f3f11f030"
                },
                {
                  "group": "bottom",
                  "id": "c63490d1-7540-4c00-a5b0-8668097ff9f8"
                },
                {
                  "group": "left",
                  "id": "f794fbce-0698-4940-9a20-ec63fe182a77"
                }
              ]
            },
            "id": "ea98db04-83bf-4619-a190-e8acf8b7b63c",
            "data": {
              "type": "tm.Store",
              "name": "Users Database",
              "description": "Stores user data, product catalog, orders, and payment info",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "f25d8fae-d408-48da-a75f-abfa3086bf2f",
                  "title": "Data Tampering in Storage",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attackers alter stored data such as prices or balances.",
                  "mitigation": "Implement database access control, checksums, and integrity verification after transactions.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": ""
                },
                {
                  "id": "9231922d-6c44-403e-84c9-d2d068393c4f",
                  "title": "Information Disclosure via Injection",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "SQL injection exposes sensitive data like user details or payment info.",
                  "mitigation": "Use prepared statements, parameterized queries, and input sanitization.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 18,
                  "score": ""
                },
                {
                  "id": "e03ca96a-7892-4ce3-80d1-9f6dd717db26",
                  "title": "Database Service Disruption",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Malicious queries or high load crash the database or lock tables.",
                  "mitigation": "Set query timeouts, backup schedules, and monitor for abnormal query patterns.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 19,
                  "score": ""
                },
                {
                  "id": "133cc37a-baf7-41ca-bf1f-8e5ca2591a30",
                  "title": "Unauthorized Database Access",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Attacker exploits weak DB credentials or misconfigured roles.",
                  "mitigation": "Use least privilege principle and rotate DB passwords regularly.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 37,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 4,
                "repudiation": 0,
                "informationDisclosure": 2,
                "denialOfService": 3
              }
            },
            "tools": {
              "items": [
                "boundary",
                "button-remove"
              ],
              "name": null
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTP Request",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "HTTP Request"
            ],
            "id": "24ea9d62-e942-4397-b836-535c01d4f971",
            "source": {
              "cell": "546317d7-9d92-41ec-8025-83b236eac145",
              "port": "2a9d13ed-2546-4078-8057-6d3392296162"
            },
            "target": {
              "cell": "e2742f77-6dbd-4efc-ae0f-0763b8906a5a",
              "port": "a7c59c66-b9dd-427a-9263-fd748339479a"
            },
            "vertices": [
              {
                "x": 460,
                "y": -160
              },
              {
                "x": 530,
                "y": -200
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTP Respon",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "HTTP Respon"
            ],
            "id": "edd32658-0303-4425-b28c-198cc0e6995e",
            "source": {
              "cell": "e2742f77-6dbd-4efc-ae0f-0763b8906a5a",
              "port": "a7c59c66-b9dd-427a-9263-fd748339479a"
            },
            "target": {
              "cell": "546317d7-9d92-41ec-8025-83b236eac145",
              "port": "da67396b-d4dc-48ba-85f4-8f024c5fa3f5"
            },
            "vertices": [
              {
                "x": 520,
                "y": -120
              },
              {
                "x": 450,
                "y": -100
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Internet Trust Boundry",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "Internet Trust Boundry"
            ],
            "id": "b789f833-8720-43e7-8114-af8d3af3d0fc",
            "source": {
              "x": 330,
              "y": -400
            },
            "target": {
              "x": 330,
              "y": 20
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Payment API Call",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "636d658d-cba6-42da-a497-d9e9619bdc58",
                  "title": "Payment API Call to gateway",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Payment data altered during API communication.",
                  "mitigation": "TLS encryption, payload signing, nonce validation.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 26,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 2,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "Payment API Call"
            ],
            "id": "a5f613c9-57df-4798-b675-5d129fa92c3f",
            "source": {
              "cell": "e2742f77-6dbd-4efc-ae0f-0763b8906a5a",
              "port": "ccfa68e4-3d72-45cc-a33a-2fd43f901cf4"
            },
            "target": {
              "cell": "6dca05b4-53b1-4b5b-a9c6-fe48d655546d",
              "port": "1a93b3f1-6596-4843-ae7d-03e968f0a848"
            },
            "vertices": [
              {
                "x": 690,
                "y": -180
              },
              {
                "x": 690,
                "y": -110
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTP Request",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "00e86502-1098-44f2-8df6-279425c795f4",
                  "title": "HTTP Request to Server",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attacker intercepts or modifies request data.",
                  "mitigation": "Use HTTPS/TLS and validate all parameters on server side.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 24,
                  "score": ""
                },
                {
                  "id": "d8641140-9541-430b-9e12-e0bc432f4bfb",
                  "title": "HTTP Response to User",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Sensitive data (e.g., tokens) leaked in responses.",
                  "mitigation": "Avoid exposing internal details, use secure cookies (HttpOnly).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 25,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "HTTP Request"
            ],
            "id": "a9033e14-c8cf-4f11-a9d0-c6c109c534be",
            "source": {
              "cell": "b29ab300-4a03-4b5c-967f-1d683fc0554a",
              "port": "3dd7fed3-5732-4d97-aacd-142105008dd7"
            },
            "target": {
              "cell": "e2742f77-6dbd-4efc-ae0f-0763b8906a5a",
              "port": "54260c7b-849f-4b93-80c0-23afb50d0d38"
            },
            "vertices": [
              {
                "x": 300,
                "y": -350
              },
              {
                "x": 420,
                "y": -330
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTP Response",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": true,
              "protocol": "",
              "threats": [
                {
                  "id": "b04e4d18-76c7-4964-ba83-dd67e8a7f6a8",
                  "title": "HTTP Response to user",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Sensitive headers or error info leaked in responses.",
                  "mitigation": "Use HTTPS, hide server banners, and sanitize server messages.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 30,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "HTTP Response"
            ],
            "id": "d6d2de31-4321-4a31-ab1b-432b95910f40",
            "source": {
              "cell": "e2742f77-6dbd-4efc-ae0f-0763b8906a5a",
              "port": "a7c59c66-b9dd-427a-9263-fd748339479a"
            },
            "target": {
              "cell": "b29ab300-4a03-4b5c-967f-1d683fc0554a",
              "port": "3d21eb4b-164d-42b5-8f61-499e10572a99"
            },
            "vertices": [
              {
                "x": 490,
                "y": -230
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "DB Request",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "8146ed11-3967-4937-9f35-8542fc86cafe",
                  "title": "DB Request ",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Malicious or injected queries alter database content.",
                  "mitigation": "Use parameterized queries and sanitize user inputs.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 31,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "DB Request"
            ],
            "id": "11e474c5-bab1-4fc4-845d-4927450a811e",
            "source": {
              "cell": "e2742f77-6dbd-4efc-ae0f-0763b8906a5a",
              "port": "709b1aca-a841-43a0-84f5-f0e37625b63b"
            },
            "target": {
              "cell": "ea98db04-83bf-4619-a190-e8acf8b7b63c",
              "port": "cefdd8c0-7c1c-4aec-87cc-993242a27c62"
            },
            "vertices": [
              {
                "x": 750,
                "y": -230
              },
              {
                "x": 820,
                "y": -200
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "DB Response",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "1d0c0bd3-826e-4206-b847-b03bfacfddf2",
                  "title": "DB Response",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Database returns excessive data (e.g., all user details).",
                  "mitigation": "Limit query outputs and mask sensitive columns.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 32,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "DB Response"
            ],
            "id": "4bd69204-0026-4e0c-a7d8-10a02cb036d1",
            "source": {
              "cell": "ea98db04-83bf-4619-a190-e8acf8b7b63c",
              "port": "f794fbce-0698-4940-9a20-ec63fe182a77"
            },
            "target": {
              "cell": "e2742f77-6dbd-4efc-ae0f-0763b8906a5a",
              "port": "709b1aca-a841-43a0-84f5-f0e37625b63b"
            },
            "vertices": [
              {
                "x": 770,
                "y": -160
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Config DB Request",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "5671be03-0cb1-4558-a7f3-0f3e3ddcc5cd",
                  "title": "Config DB Request Admin to Config Store",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Unprotected admin request can be hijacked or replayed.",
                  "mitigation": "Use encrypted admin channels and API authentication tokens.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 33,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "Config DB Request"
            ],
            "id": "3e371e3b-18c7-4bd4-b8b4-be966c5c7d1a",
            "source": {
              "cell": "e2742f77-6dbd-4efc-ae0f-0763b8906a5a",
              "port": "54260c7b-849f-4b93-80c0-23afb50d0d38"
            },
            "target": {
              "cell": "0999a17a-25c1-4695-af28-537e83a4b29a",
              "port": "a470bd85-a8c8-4023-bb62-c8fdb492a7cb"
            },
            "vertices": [
              {
                "x": 760,
                "y": -340
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Config DB Response",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "e40d02d2-37bf-4797-a8f9-d6c491045076",
                  "title": "Config DB Response Config db to Admin",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Config data with secrets exposed in plain text.",
                  "mitigation": "Mask or encrypt secrets before display, limit access to trusted roles.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 34,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "Config DB Response"
            ],
            "id": "686c9df7-4726-4743-9c4a-821b2df13b2e",
            "source": {
              "cell": "0999a17a-25c1-4695-af28-537e83a4b29a",
              "port": "501a267c-818d-4f4d-af89-3d1b60b44d11"
            },
            "target": {
              "cell": "e2742f77-6dbd-4efc-ae0f-0763b8906a5a",
              "port": "54260c7b-849f-4b93-80c0-23afb50d0d38"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Payment Status Reponse",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "126aede6-9fe5-4351-b679-6afdd3e939c3",
                  "title": "Payment Status Response Gateway to App ",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Fake response from attacker makes app mark payments as successful.",
                  "mitigation": "Verify signed responses and validate transaction IDs against gateway records.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 35,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "Payment Status Reponse"
            ],
            "id": "6f9de99d-cfcb-4cce-b771-4a26958943ca",
            "source": {
              "cell": "6dca05b4-53b1-4b5b-a9c6-fe48d655546d",
              "port": "cc2af675-3e4c-4022-9f4e-45d0be36ca37"
            },
            "target": {
              "cell": "e2742f77-6dbd-4efc-ae0f-0763b8906a5a",
              "port": "ccfa68e4-3d72-45cc-a33a-2fd43f901cf4"
            },
            "vertices": [
              {
                "x": 600,
                "y": -100
              },
              {
                "x": 600,
                "y": -150
              }
            ]
          },
          {
            "position": {
              "x": 110,
              "y": -160
            },
            "size": {
              "width": 170,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Administrator"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 11,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "2a9d13ed-2546-4078-8057-6d3392296162"
                },
                {
                  "group": "right",
                  "id": "da67396b-d4dc-48ba-85f4-8f024c5fa3f5"
                },
                {
                  "group": "bottom",
                  "id": "2ef79c3e-bd0f-41fc-b809-f64789fe4dc8"
                },
                {
                  "group": "left",
                  "id": "7900f323-5b2b-42f3-b9bb-61cce440a3c5"
                }
              ]
            },
            "id": "546317d7-9d92-41ec-8025-83b236eac145",
            "data": {
              "type": "tm.Actor",
              "name": "Administrator",
              "description": "",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": true,
              "threats": [
                {
                  "id": "fa53a42f-51f6-4508-a029-e7c9d10bd238",
                  "title": "Admin User Spoofing",
                  "status": "Mitigated",
                  "severity": "Critical",
                  "type": "Spoofing",
                  "description": "Attacker gains access by stealing or brute-forcing admin credentials.",
                  "mitigation": "Use 2FA for admin logins, restrict access by IP, and strong password rotation.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 14,
                  "score": ""
                },
                {
                  "id": "ba6f0317-ac7b-4aae-a447-ca4872e985f3",
                  "title": "Admin Action Repudiation",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Repudiation",
                  "description": "Admin denies making website or config changes without traceability.",
                  "mitigation": "Maintain admin activity logs, digital signatures, and change management records.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 15,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "repudiation": 3
              }
            }
          },
          {
            "position": {
              "x": 959,
              "y": -290
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Website Configration\nFiles"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 12,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "a470bd85-a8c8-4023-bb62-c8fdb492a7cb"
                },
                {
                  "group": "right",
                  "id": "d5edd182-4296-4362-86fb-388993ee4226"
                },
                {
                  "group": "bottom",
                  "id": "70a49943-a49c-4ba5-8946-2fa4b2f45e3d"
                },
                {
                  "group": "left",
                  "id": "501a267c-818d-4f4d-af89-3d1b60b44d11"
                }
              ]
            },
            "id": "0999a17a-25c1-4695-af28-537e83a4b29a",
            "data": {
              "type": "tm.Store",
              "name": "Website Configration\nFiles",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "0f86b335-5ca9-49f4-9b16-36644cd8cb9d",
                  "title": "Config File Tampering",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attackers alter website config files to redirect users or disable security.",
                  "mitigation": "Apply file integrity monitoring, read-only permissions, and version control (Git).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": ""
                },
                {
                  "id": "2d2e101a-65c1-4083-a897-1abd06192b8e",
                  "title": "Information Disclosure via Config Files",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Sensitive keys or DB credentials leaked in exposed config files.",
                  "mitigation": "Store credentials in environment variables or secret vaults not plain text files.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": ""
                },
                {
                  "id": "6b62bae2-bcbe-4f35-9227-b49cddbbd90e",
                  "title": "Configuration Service Disruption",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Deletion or corruption of config files causes system downtime.",
                  "mitigation": "Keep regular backups, and limit write permissions to trusted admins only.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 2,
                "repudiation": 0,
                "informationDisclosure": 2,
                "denialOfService": 3
              }
            }
          },
          {
            "position": {
              "x": 570,
              "y": -20
            },
            "size": {
              "width": 120,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "Payment \nGateway"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 13,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "78076e71-ed58-4b0b-8b92-85d3613d3092"
                },
                {
                  "group": "right",
                  "id": "1a93b3f1-6596-4843-ae7d-03e968f0a848"
                },
                {
                  "group": "bottom",
                  "id": "5fdb99f3-d79c-4363-880f-33e9b6c2f61f"
                },
                {
                  "group": "left",
                  "id": "cc2af675-3e4c-4022-9f4e-45d0be36ca37"
                }
              ]
            },
            "id": "6dca05b4-53b1-4b5b-a9c6-fe48d655546d",
            "data": {
              "type": "tm.Process",
              "name": "Payment \nGateway",
              "description": "External payment service",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "f405bfc6-8f02-4752-9094-bf3a2d4f8a82",
                  "title": "Fake Payment Gateway Spoofing",
                  "status": "Mitigated",
                  "severity": "Critical",
                  "type": "Spoofing",
                  "description": "Users redirected to fake gateway to steal data.",
                  "mitigation": "Use HTTPS, domain validation, and whitelist trusted payment URLs.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 20,
                  "score": ""
                },
                {
                  "id": "c9e0c199-8441-46ee-9936-7d74ef99194a",
                  "title": "Payment Data Tampering",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Payment details modified during transmission",
                  "mitigation": "Use TLS, HMAC signatures, and server-side validation.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 21,
                  "score": ""
                },
                {
                  "id": "abc21cdd-6c41-45f4-b6da-9e757b793f6a",
                  "title": "Payment Info Disclosure",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Card data exposed if no encryption or tokenization.",
                  "mitigation": "Enforce PCI DSS, HTTPS, and avoid storing card data.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 22,
                  "score": ""
                },
                {
                  "id": "472ce77f-2715-4296-8494-979d4e37e036",
                  "title": "Payment Service Unavailable",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Gateway downtime disrupts transactions.",
                  "mitigation": "Add fallback payment options, retries, and logging.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 23,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 1,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 2,
                "elevationOfPrivilege": 0
              }
            }
          }
        ],
        "description": "Threat model for a small e-commerce application using STRIDE"
      }
    ],
    "diagramTop": 1,
    "reviewer": "TCS",
    "threatTop": 37
  }
}